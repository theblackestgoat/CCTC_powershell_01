ROCR-002-W
10.50.29.33
Stack ID 3
start 2347
registry start357
ads start3486
linux start5309
windows boot start8633
linux boot start3675
windows process validity start
windows uac start0864
windows services start4597
linux process validity start1640
windows auditing and logging start3567
linux auditing and logging start2021
memory analysis start4477
windows active directory enumeration start5557

https://vta.cybbh.space/horizon/project/instances/

Intro and Setup
field guide: https://os.cybbh.io/public/os/latest/
navigate to 10.50.21.26:8000
join class W23002 password

What version of PS am I using
PS C:\> Get-Host | Select-Object Version

To switch versions
PS C:\> pwsh

Primer_CLI_1. Which program starts with every CMD and PowerShell instance in Windows 7 and later?
Research: https://devblogs.microsoft.com/commandline/windows-command-line-inside-the-windows-console/
Answer: conhost.exe

Primer_CLI_2. What Windows 10 feature supports installing Linux subsystem?
Research: https://learn.microsoft.com/en-us/windows/wsl/about
Answer: WSL (Windows Subsystem for Linux)

Primer_CLI_3. Which Windows feature can be used to interact with any CLI on the Windows system concurrently using multiple tabs?
Research: https://learn.microsoft.com/en-us/windows/terminal/
Answer: Windows Terminal

Primer_CLI_4. What was the default shell (command line) of Windows versions Windows 2000 through Windows 8.1?
Research: https://learn.microsoft.com/en-us/windows-hardware/customize/enterprise/shell-launcher
Answer: cmd.exe

Primer_CLI_5. What data type do all cmd.exe commands return?
Research: https://en.wikipedia.org/wiki/Comparison_of_command_shells (Hint: What data type is "text"?)
Answer: string

Primer_CLI_6. What framework is PowerShell built on?
Research: https://en.wikipedia.org/wiki/.NET
Answer: .net

Primer_CLI_7. "What will all of the below give you?
(get-host).version
$host.version
$psversiontable.psversion"
Research: https://devblogs.microsoft.com/scripting/powertip-check-version-of-powershell/
Answer: Powershell Version

Primer_CLI_8. After PowerShell Core is installed what CLI command launches it?
Research: https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.2
Answer: pwsh

Primer_CLI_9. "After PowerShell Core is installed you can still run the built in version of PowerShell side-by-side. What CLI command will launch the built in version?"
Research: Primer_CLI_9 https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/powershell
Answer: powershell.exe

Windows_PowerShell_Basics_1. 
What syntax do PowerShell cmdlets follow?
Answer: verb-noun

Windows_PowerShell_Basics_2. What PS command will list all PowerShell cmdlets?
Answer: Get-Command

Windows_PowerShell_Basics_3. What PowerShell command will list all verbs?
Answer: Get-Verb

Windows_PowerShell_Basics_4. BASH commands output strings. PowerShell commands output what data type?
Answer: object
 
Windows_PowerShell_Basics_5. All PowerShell objects are comprised of what two things?
Flag format: things,things
Answer: properties,methods

Windows_PowerShell_Basics_6. What command will list all things that make up a PowerShell object?
Answer: Get-Member

Windows_PowerShell_Basics_7. What PowerShell command will list PowerShell aliases?
Answer: Get-Alias

Windows_PowerShell_Basics_8. What PowerShell command lists all of the contents of a directory?
Answer: Get-ChildItem

Windows_PowerShell_Help_1. What is the basic cmdlet that displays help about Windows Powershell cmdlets and concepts?
Answer: Get-Help

Windows_PowerShell_Help_2. PowerShell "help files" don't show the entire help file with a basic command. What switch option shows the entire help file?
Answer: -Full

Windows_PowerShell_Help_3. What PowerShell command will update the PowerShell "help files" to the latest version?
Answer: Update-Help

Windows_PowerShell_Help_5. What help switch will show you the "help files" on Microsoft's website, in your default browser?
Answer: -Online

Windows_PowerShell_Interaction_1. What command will start the Chrome browser on your machine?
Answer: start chrome

Windows_PowerShell_Interaction_2. What command using a PS Method will stop chrome?
Flag is the full command.
Answer: (get-process chrome).kill()

Windows_PowerShell_Interaction_3. What PowerShell command (without using a method) will stop the Chrome process?
Answer: Stop-Process -name chrome

Windows_PowerShell_CimClasses_1.
PowerShell doesn't have a native cmdlet that will give you processor information (such as get-processor or get-cpu). Knowing this information might be necessary. What command would give you information about the system's processor?
Flag is the full command
Answer: Get-WmiObject -Class Win32_Processor

Windows_PowerShell_Logic_1. What PowerShell command will read a text file?
Answer: Get-Content

Windows_PowerShell_Logic_2. What PowerShell command will allow for counting lines in a file, averaging numbers, and summing numbers?
Answer: Measure-Object

Windows_PowerShell_Regex_1. What PowerShell command searches for text patterns in a string?
Answer: Select-String

Windows_PowerShell_Basics_9. Users' files are stored in their corresponding home directory. What is the literal path to all home directories on a Windows 10 system?
Answer: C:\Users\

Windows_PowerShell_Basics_7. How many properties are available for the get-process cmdlet?
Note: Property values only
Answer: 52

Windows_PowerShell_Alias_3. How many aliases does PowerShell have for listing the contents of a directory?
Answer: 3

Windows_PowerShell_Help_4. When requesting the help file for the get-process cmdlet, what full command is the 9th example given?
Answer: get-process powershell

Windows_PowerShell_CimClasses_2. To complete this challenge, find the description of the Lego Land service.
Get-WmiObject win32_service | ?{$_.NAME -like 'LegoLand'} | select Name,Description
Answer: i_love_legos

Windows_PowerShell_Logic_3. In the CTF folder on the CTF User's Desktop, count the number of words in words2.txt.
(Get-Content .\words2.txt).count
Answer: 5254

Windows_PowerShell_Logic_4. Count the number of files in the Videos folder in the CTF user's home directory.
(Get-ChildItem -Path .\Videos\).count
Andwer: 925

Windows_PowerShell_Logic_5. Find the only line that makes the two files in the CTF user's Downloads folder different.
Hint The flag is the string (not line number).
diff (Get-Content new.txt) (Get-Content old.txt))
Answer: popeye

Windows_PowerShell_Logic_6. The password is the 21st line from the top, in ASCII alphabetically-sorted, descending order of the words.txt file.
**Note: File Location - C:\Users\CTF\Desktop\CTF
(Get-Content .\words.txt | sort -Descending)[20]
Answer: ZzZp

Windows_PowerShell_Logic_7. Count the number of unique words in words.txt
**Note: File Location - C:\Users\CTF\Desktop\CTF
$A = $(foreach ($line in Get-Content .\words.txt) {$line.tolower().split(" ")}) | sort | Get-Unique
$A.count
Answer: 456976

Windows_PowerShell_Basics_8. How many methods are available for the get-process cmdlet?
Machine: Admin_Station
Answer: 14

Windows_Powershell_Logic_9. Count the number of folders in the Music folder in the CTF user’s profile.
(get-ChildItem -Path .\Music\).count
Answer: 411

Windows_PowerShell_Regex_2. Count the number of times, case-insensitive, gaab is listed in words.txt **Note: File Location - C:\Users\CTF\Desktop\CTF
(Get-Content .\words.txt | Select-String "gaab").count
Answer: 1

Windows_PowerShell_Regex_3. Count the number of words, case-insensitive, with either a or z in a word, in the words.txt file
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Hint: There are multiple "words" on each line.
$A = $(foreach ($line in Get-Content .\words.txt) {$line.tolower().split(" ")}) -match '[az]+'
$A.count
Answer: 160352

Windows_PowerShell_Logic_8. Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.
Note: Make sure you back up the .zip file to a different directory before attempting this challenge.
Omega"$n".zip
for ($n = 1000; $n -gt 0; $n--){Expand-Archive .\omega"$n".zip -DestinationPath .} 
Answer: kung-fu

Windows_PowerShell_Regex_5. Count the number of words in words.txt that meet the following criteria:
    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...
$pattern = "[a-g]"    
$A = $(foreach ($line in Get-Content .\words.txt) {$line.tolower().split(" ")}) -match ".*aa$pattern*."
$A.count
Answer: 357

Windows_PowerShell_Profiles_8. Challenge only allows ONE attempt
Malware is running in a PowerShell profile on the File-Server. Based on PowerShell profile order of precedence (what is read first), find the correct flag.
The flag is the string after the #, without the preceding space.
Get-Content $PROFILE.AllUsersAllHosts
Answer: I am definitely not the malware

Windows_PowerShell_Profiles_1.5 Which PowerShell profile has the lowest precedence?
Answer: CurrentUserCurrentHost

Windows_PowerShell_Profiles_2. Which PowerShell profile has the highest precedence?
Answer: AllUsersAllHosts

Windows_PowerShell_Profiles_3. Which PowerShell variable stores the current user’s home directory?
Answer: $HOME

Windows_PowerShell_Profiles_4. Which PowerShell variable stores the installation directory for PowerShell?
Answer: $PsHome

Windows_PowerShell_Profiles_5. Which PowerShell variable stores the path to the "Current User, Current Host" profile?
Answer: $PROFILE

Windows_PowerShell_Profiles_6. What command would you run to view the help for PowerShell Profiles?
Answer: Get-Help about_profiles

Windows_PowerShell_Profiles_7. What command would tell you if there was a profile loaded for All Users All Hosts?
Flag is the full command syntax
Answer: Test-Path -Path $PROFILE.AllUsersAllHosts




Primer_Registry_1. What Windows registry path is the Volatile Hive?
Research: https://vistech.net/~champ/online-docs/books/mwin2reg/ch11-30975.html
Answer: HKLM\HARDWARE

Primer_Registry_2. What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?
Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/application-management/wow6432node-registry-key-present-32-bit-machine
Answer: HKEY_LOCAL_MACHINE\SOFTWARE

Primer_Registry_3. In what registry path are the BOOT_START drivers located?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree
Answer: HKLM\SYSTEM\CurrentControlSet\Services

Primer_Registry_4. What start value do BOOT_START drivers have in the registry?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order
Answer: 0x0

Primer_Registry_5. During kernel initialization, what registry location is read containing all SYSTEM_START drivers and services with a start value of 0x1?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree
Answer: HKLM\SYSTEM\CurrentControlSet\Services

Primer_Registry_6. Auto_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order
Answer: 0x02

Primer_Registry_7. What start value do DEMAND_START drivers and services have in the registry?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order
Answer: 0x3

Primer_Registry_8. When accessing a remote registry which are the only 2 accessible HKEYs?
SYNTAX Hive, Hive
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-load
Answer: HKLM, HKU

Primer_Registry_9. What PowerShell cmdlet will list currently mapped drives?
Research: https://learn.microsoft.com/en-us/powershell/scripting/samples/managing-windows-powershell-drives?view=powershell-7.2
Answer: Get-PSDrive

Primer_Registry_10. What is the native Windows GUI tool for managing the registry?
Research: https://support.microsoft.com/en-us/windows/how-to-open-registry-editor-in-windows-10-deab38e6-91d6-e0aa-4b7c-8878d9e07b11
Answer: regedit.exe

Windows_Registry_Basics_1. What registry hive contains all machine settings?
Answer: HKEY_LOCAL_MACHINE

Windows_Registry_Basics_2. What registry hive contains all user settings?
Answer: HKEY_USERS

Windows_Registry_Basics_3. What registry hive contains only the currently logged-in user's settings?
Answer: HKEY_CURRENT_USER

Windows_Registry_Basics_4. The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?
Flag format: HIVE\SID.........................
Answer: HKEY_USERS\S-1-5-21-105181296-3876013222-3871917967-1000

Windows_Registry_Basics_5. What PowerShell command will list all the subkeys and contents in the current directory and/or will list all the subkeys and the contents of a directory you specify?
Answer: Get-ChildItem

Windows_Registry_Basics_6. What PowerShell command will list only the contents of a registry key or subkey?
Answer: Get-Item

Windows_Registry_Basics_7. What registry subkey runs every time the machine reboots? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
Answer: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run

Windows_Registry_Basics_8. What registry subkey runs every time a user logs on? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
Answer: HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUN

Windows_Registry_Basics_9. What registry subkey runs a single time, then deletes its value once the machine reboots? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
Answer: HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE

Windows_Registry_Basics_10. What registry subkey runs a single time, then deletes its value when a user logs on? The flag is the full path, using PowerShell.
Flag format: FULL\PATH\ALL\CAPS
Answer: HKEY_CURRENT_USER\SOFTWARE\MICROSOFT\WINDOWS\CURRENTVERSION\RUNONCE

Windows_Registry_Basics_11. What is the value inside of the registry subkey from your previous challenge named registry_basics_7?
CMD:
C:\Users\andy.dwyer>reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run                                                                                                                                        HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run                                                            SecurityHealth    REG_EXPAND_SZ    %ProgramFiles%\Windows Defender\MSASCuiL.exe                                         
Kaspersky    REG_SZ    C:\malware.exe 
PS:
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
Answer: malware.exe

Windows_Registry_Basics_12. What is the value inside of the registry subkey that loads every time the "Student" user logs on?
To get the "student" SID:
Get-WmiObject -Class Win32_UserAccount -Filter "Name='student'"
Make a new PSDrive
New-PSDrive -Name HKU -PSProvider Registry -Root HKEY_USERS
Navigate into that new drive
cd Registry::HKEY_LOCAL_MACHINE 
cd HKU:
CD into the SID for the student
Get-ItemProperty
then provide the filepath
Answer: C:\botnet.exe

Windows_Registry_Basics_13. What is the value inside of the registry subkey from registry_basics_9?
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce"
Answer: Virus.exe

Windows_Registry_Basics_14. What is the value inside of the registry subkey that loads a single time when the "student" user logs on?
Look at how to do #12
Answer: C:\worm.exe

Windows_Registry_Basics_15. Figure out the manufacturer's name of the only USB drive that was plugged into this machine.
Get-ChildItem - path "HKLM:\SYSTEM\CurrentControlSet\Enum\USB*"
Answer" SanDisk

Windows_Registry_Basics_16. What suspicious user profile, found in the registry, has connected to this machine?
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\ProfileList"
Answer: Hacker_McHackerson

Windows_Registry_Basics_17. What suspicious wireless network, found in the registry, has this system connected to?
Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\NetworkList\Profiles"
Answer: Terror_cafe_network




Primer_NTFS_1. The ____ determines how the data is stored on disk.
(Fill in the blank)
Research: https://social.technet.microsoft.com/wiki/contents/articles/5375.windows-file-systems.aspx

Answer: file system
Primer_NTFS_2. What are NTFS partition sectors grouped into?
Research: https://learn.microsoft.com/en-us/windows-server/storage/file-server/ntfs-overview
Answer: clusters

Primer_NTFS_3. What contains the metadata about all of the files and directories on a NTFS partition?
Research: https://learn.microsoft.com/en-us/windows/win32/devnotes/master-file-table
Answer: master file table

Primer_NTFS_4. NTFS files are collections of what?
(Hint: What are the user data streams? or all streams for that matter) Research: https://learn.microsoft.com/en-us/windows/win32/devnotes/master-file-table
Answer: attributes

Primer_NTFS_5. Which NTFS attribute would store an alternate data stream?
Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3
Answer: $DATA

Primer_NTFS_6. Which NTFS attribute holds information about a file's encrypted attributes?
Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/a82e9105-2405-4e37-b2c3-28c773902d85
Answer: $LOGGED_UTILITY_STREAM

Primer_NTFS_7. Which NTFS attribute that is composed of the file security and access control properties?
Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/a82e9105-2405-4e37-b2c3-28c773902d85
Answer: $SECURITY_DESCRIPTOR

Primer_NTFS_8. In NTFS, what is the type id, in hex, of the attribute that actually stores a NTFS files contents?
Research: https://flatcap.github.io/linux-ntfs/ntfs/attributes/data.html
Answer: 0x80

Primer_NTFS_9. In NTFS what is the maximum number of bytes a MFT entry (containing the entirety of a file) can contain to be considered "Resident Data"?
Research: https://www.sciencedirect.com/topics/computer-science/master-file-table https://en.wikipedia.org/wiki/NTFS
Answer: 1024

Primer_NTFS_10. NTFS permissions can be a assigned to a filesystem object in two ways. Which way is intentionally assigned on the file or folder?
Research: https://devblogs.microsoft.com/scripting/weekend-scripter-use-powershell-to-get-add-and-remove-ntfs-permissions/
Answer: explicit ( as opposed to inheritance )

Primer_NTFS_11, NTFS permissions can be a assigned to a filesystem object in two ways. Which way is the results of an object being assigned permissions as the result of being the child of another object?
Research: https://devblogs.microsoft.com/scripting/weekend-scripter-manage-ntfs-inheritance-and-use-privileges/
Answer: Inheritance

Primer_NTFS_12. Which NTFS file level permission is missing from the following list? Write, Read & Execute, Modify, Full Control
Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN
Answer: read

Primer_NTFS_13. Which NTFS folder level permission is missing from the following list?: Read, Write, Read & Execute, Modify, Full control
Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN
Answer: list folder contents

Primer_NTFS_14. Which NTFS file level permission permits changing the contents of a file, deleting the file but does not allow the ability to change the permissions on the file?
Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN
Answer: modify

Primer_NTFS_15. Which NTFS folder level permission allows changing permissions?
Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc783530(v=ws.10)?redirectedfrom=MSDN
Answer: full control

Primer_NTFS_16. Which NTFS attribute stores the file times of an object?
Research: https://flatcap.github.io/linux-ntfs/ntfs/attributes/standard_information.html
Answer: $STANDARD_INFORMATION

Primer_NTFS_17. What CLI command will only show the letters of attached drives? **Hint command is 3 words
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil-fsinfo
Answerfsutil fsinfo drives

Windows_File_System_Basics_1. Every file on a Windows system has attributes. What does the d attribute mean?
Answer: directory
Windows_File_System_Basics_2. Every file on a Windows system has attributes. What does the h attribute mean?
Answer: hidden

Windows_File_System_Basics_3. What PowerShell command will list all files in the current directory, regardless of their attributes?
Answer: Get-ChildItem -Force

Windows_File_System_Basics_4. What PowerShell command will give you the sha512 hash of a file?
Flag format: command -argument
Answer: Get-FileHash -Path <your file path> -Algorithm SHA512

Windows_File_System_Basics_5. What PowerShell command will list permissions of a file?
Answer: Get-ACL (Access Control List)

Windows_File_System_Basics_6. What Windows file maps hostnames to IP addresses?
Answer: hosts

Windows_File_System_Basics_7. Which group has ReadandExecute (RX) permissions to the file listed in the previous challenge, File_System_Basics_6?
Get-ACL C:\Windows\System32\drivers\etc\hosts | Fprmat-List Property *
Answer: BUILTIN\Users

Windows_File_System_Basics_8. Find the last five characters of the MD5 hash of the hosts file.
Get-FileHash .\hosts -Algorithm MD5
Answer: Just read the last 5 characters

Windows_File_System_Basics_9. Examine the readme file somewhere in the CTF user’s home directory.
Get-ChildItem -Path C:\Users\computerperson\ -Include *readme* -Recurse -ErrorAction SilentlyContinue
Answer: 123456

Windows_File_System_Basics_10. There is a hidden directory in the CTF user's home directory. The directory contains a file. Read the file.
cd into the CTF home directory
Get-ChildItem -Force
Answer: ketchup

Windows_File_System_Basics_11. Find a file in a directory on the desktop with spaces in it. FLAG is the contents of the file
HINT: If you like to type the full names and paths of files, you better look for a shortcut.
Answer: 987654321

Windows_File_System_Basics_12. Find the Alternate Data Stream in the CTF user's home, and read it.
This is kinda ridiculous but...
Get-ChildItem -Path "C:\Users\Username" -Recurse | ForEach-Object { $filePath = $_.FullName; $streamList = Get-Item -Path $filePath -Stream * | Where-Object { $_.Length -gt 0 }; if ($streamList) { Write-Output "Alternate Data Streams found in file: $filePath"; $streamList | Format-Table -Property Stream, Length -AutoSize; Write-Output "------------------" } }
Run this and look for alternate data streams. 
navigate to directory of interest and search for ADS with dir /R * or PS Get-ChildItem -Force *
then read the content of ex. nothing_here:hidden:$DATA
Answer: P455W0RD

Windows_File_System_Basics_14. There are plenty of phish in the C:\, but sometimes they're hidden in plain site.
Find the phish.
(This one is stupid)
Find a directory with WWW
in CMD, run dir /R /A
Find the file with content and read it with:
more *
Answer: phi5hy





Linux Basics 1. What command lists the contents of directories in Linux/Unix systems?
Answer: ls

Linux Basics 2. For the ls command, what arguments, or switch options, will allow you to print human-readable file sizes in a long-list format?
The flag is entire command, including arguments
Answer: ls -lh

Linux Basics 3. What character will pipe the standard output from
echo "I’m a plumber" to another command, as standard input?
Answer: |

Linux Basics 4. What argument/switch option, when used with man, will search the short descriptions and man-page-names for a keyword that you provide?
The flag is the complete command, with argument/switch.
Answer: man -k

Linux Basics LFS Hierarchy. What is the absolute path to the root directory?
Answer: /

Linux Basics LFS Hierarchy2. What is the absolute path to the default location for configuration files?
Answer: /etc

Linux Basics LFS Hierarchy3. What is the directory that contains executable programs (binaries) which are needed in single user mode, to bring the system up or to repair it?
Answer: /bin

Linux Basics LFS Hierarchy4. What is the absolute path to the directory which contains non-essential binaries that are accessible by standard users as well as root?
Answer: /usr/bin

Linux Basics LFS Hierarchy5. An absolute path to a directory which contains binaries only accessible by the root user, or users in the root group.

Answer: /sbin

Linux Basics LFS Hierarchy6. What is the absolute path for the binary cat man-page?
use whereis cat
Answer: /usr/share/man/man1/cat.1.gz 

Linux Basics LFS Hierarchy7. Search the user home directories to find the file with the second-most lines in it. Hint: Exclude the VDI file! The flag is the number of lines in the file.
change to the home directory
cd ~
get the file sizes 
ls -la
get the count of lines in the documents
wc -l 
Answer: 40000

Linux Basics Users and Groups1. Read the file that contains the user database for the machine. Identify a strange comment.
look for weird stuff by using
cat /etc/passwd | grep -v "nologin"
Answer: Traitor

Linux Basics Users and Groups2. Identify all members of the lodge group. List their names in alphabetical order with a comma in between each name.
Flag Format: name,name,name
$ awk -F':' '/lodge/{print $4}' /etc/group 
garviel,tarik,aximand,ezekyle,sejanus,erebus 
Answer: aximand,erebus,ezekyle,garviel,sejanus,tarik

Linux Basics Users and Groups3. Find the user with a unique login shell.
look back at Groups1
Answer: nobody

Linux Basics Users and Groups4. Identify the algorithm, the amount of salted characters added, and the length of the hashed password in the file that stores passwords.
Hint: Research 'padding'...
Flag format: algorithm,#characters,#length
Answer??????????????????????????????????????????????????????????????????????????????

Linux Basics Permissions1. Find the directory named Bibliotheca. Enter the absolute path to the directory.
sudo find / -type d -name "Bibliotheca"
Answer: /media/Bibliotheca  

Linux Basics Permissions2. Identify the number of users with valid login shells, who can list the contents of the Bibliotheca directory.
Answer????????????????????????????????????????????????????????????

Linux Basics Regular Expressions1. Using the commands ls and grep, identify the number of directories in /etc/ that end in .d
ls | grep *.d
Answer: 27

Linux Basics Regular Expressions2. File: home/garviel/numbers
Use regular expressions to match patterns similar to an IP address.
The answer is the count/number of lines that match in the file.
garviel@terra:~$ grep -E -o "(^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$)" numbers | wc -l   
Answer: 156   

Linux Basics Regular Expressions3. File: home/garviel/numbers
Use regular expressions to match valid IP addresses. The flag is the number of addresses.
HINT: What are the valid numerical values of each octet in an IP address?
grep -E -o "\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b" numbers | wc -l
Answer: 36

Linux Basics Regular Expressions4. File: home/garviel/numbers
Use regular expressions to match patterns that look similar to a MAC Address. Flag is a count of the number of matches.
HINT: This is a loose match! Some of these results won't be true MAC addresses.
Flag format: ####
grep -Ei '^[0-9A-Z]{1,2}(-[0-9A-Z]{1,2}){5}$' numbers | wc -l
Answer: 9754

Linux Basics Permissions9. Read the concealed file within /media/Bibliotheca
Recursively search through a directory for a hidden file
find /media/Bibliotheca/ -type f -name '.*' -exec cat {} \; 
Answer: Expand you mind

Linux Basics Reformat1. File: home/garviel/numbers
Use awk to print lines:
>= 420 AND <=1337
The flag is a SHA512 hash of the output.
awk 'NR >= 420 && NR <= 1337' /home/farviel/numbers | sha512sum
Answer: e62ff70d772ef0977f4f8fe1751fda5689ce1daf1fabc6d0cc49da234d02719986c0acb97f582166170a5a1f418e854602a5eb98c773655906a3f85440c37d39

Linux Basics Bash Logic3
FILE: /home/garviel/Inquisition_Targets
Identify heresy by comparing the Inquisition_Targets file to members of the Guardsmen group.
HINT: Reformat and clean up the data before it is compared. awk and sort are your best friends!
The flag is the number of heretics on the system.
comm -12 <(cat /etc/group | awk -F: '{print $1}' | sort) <(cat Inquisition_Targets | sort)
Abrunaer 
Rubric 
Tzeentch
Ahriman
Ankhu_Anen 
Baleq_Uthizaar
Henry_Heresy
Mortekos 
Answer: 8

Linux Basics Permissions2. Identify the number of users with valid login shells, who can list the contents of the Bibliotheca directory.
First, determine the number of users with valid login shells
getent passwd | awk -F: '$7 != "/usr/sbin/nologin" && $7 != "/bin/false" && $7 != "/bin/true" {count++} END {print count}'
Get details of the users with valid shells
getent passwd | awk -F: '$7 != "/usr/sbin/nologin" && $7 != "/bin/false" && $7 != "/bin/true" {print}'
###
How to better understand details of the users
    Username: quixos - This is the username of the user.
    Password: x - In the /etc/passwd file, the password field usually contains a placeholder character 'x', indicating that the password is stored in the /etc/shadow file or another secure location.
    User ID (UID): 1132 - This is the unique numeric identifier assigned to the user by the system.
    Group ID (GID): 1136 - This is the group ID of the user. It indicates which group the user belongs to.
    User ID Info: - This field is usually reserved for additional user information, such as the full name or description. In this example, it is empty.
    Home Directory: /home/quixos - This is the user's home directory, where the user's personal files and configurations are typically stored.
    Login Shell: /bin/bash - This field specifies the default shell for the user. It determines the command interpreter that is used when the user logs in.
So, in summary, the user entry quixos:x:1132:1136::/home/quixos:/bin/bash represents a user named quixos with a UID of 1132, a GID of 1136, a home directory at /home/quixos, and a default login shell set to /bin/bash.
Linux Basics Permissions10. Find the warp and read its secrets for the flag.
garviel@terra:/media/Bibliotheca/Bibliotheca_duo$ find /media/Bibliotheca/Bibliotheca_duo/.warp* -type f -exec cat {} \;  
Answer: Ph'nglui mglw'nafh Cthulhu 

Linux Basics Reformat2. File: home/garviel/connections
Use awk to create a separate CSV (comma separated value) file that contains columns 1-6.
The flag is an MD5 hash of the new file
Hint: Look at #fields on line 6 in the file to understand column layout.
Hint: This is a Zeek (formally known as Bro) connection log file in TSV format. Click This Link to learn about its formatting.
Sample Output
#separator \x09,,,,,
#set_separator,,,,,,
#empty_field,(empty),,,,
#unset_field,-,,,,
#path,conn,,,,
#open,2021-03-09-14-26-54,,,,
#fields,ts,uid,id.orig_h,id.orig_p,id.resp_h
#types,time,string,addr,port,addr
1615299704.748741,Cynd96jpqm760uz0k,192.168.242.216,60508,192.168.65.20,22
1615299962.756967,CFWnz12Wd2cXj3iSIe,fe80::c95c:6e92:5618:9df7,546,ff02::1:2,547
1615300118.087124,CuVCPTMljpoBDEuR1,192.168.65.10,62117,10.50.255.254,53
--- Trimmed ---
awk 'BEGIN {FS = "\t"; OFS=","}{print $1, $2, $3, $4, $5, $6}' /home/garviel/connections > /home/garviel/connections.csv && md5sum /home/garviel/connections.csv | cut -d '' -f 1    
Answer: 88d8d7ff29cac0e85c5c7f1600770dfd  /home/garviel/connections.csv  

Linux Basics Regular Expressions5. File: home/garviel/numbers
Use regular expressions to find valid Locally Administered or Universally Administered Unicast MAC addresses.
Give the count of Locally and Universally Administered MAC addresses as the answer.
HINT: What characters specifically define a Locally or Universally Administered Unicast MAC Address?
garviel@terra:~$ cat numbers | egrep '^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$' | awk -F '-' {'print $1'} | awk -F '' {'print $2'} | egrep '[048C26AE]' | wc -l                                 
356  





Primer_Boot_Process_1. What is the smallest addressable unit on a hard disk?
Research: https://learn.microsoft.com/en-us/windows/win32/fileio/disk-devices-and-partitions
Answer: sector

Primer_Boot_Process_2. What term describes a logical division of a single storage device?
Research: https://learn.microsoft.com/en-us/windows/win32/fileio/disk-devices-and-partitions
Answer: partition

Primer_Boot_Process_3. What term describes a formatted storage device that can span 1 or more partitions, has a single file system and is assigned a drive letter?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/storage-device-stacks--storage-volumes--and-file-system-stacks
Answer: volume

Primer_Boot_Process_4. What CLI disk partitioning tool is available in Windows to view and manipulate both partitions and volumes?
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/diskpart
Answer: diskpart

Primer_Boot_Process_5. Windows includes 4 critical Kernel-mode components. Which component is a matched pair with the kernel and obfuscates the hardware dependencies from the kernel?
Kernel
Executive
HAL
Device
Research: https://en.wikipedia.org/wiki/Hardware_abstraction
Answer: HAL (Hardware Abstraction Layer)

Primer_Boot_Process_6. Windows includes 4 critical Kernel-mode components. Which component directs calls from a user-mode process to the kernel services?
Kernel
Executive
HAL
Device
Research: https://en.wikipedia.org/wiki/Architecture_of_Windows_NT#Executive
Answer: Executive

Primer_Boot_Process_7. This provides an operating system with a software interface to a hardware device
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/what-is-a-driver-
Answer: driver

Primer_Boot_Process_8. What are the two firmware interfaces supported by modern computers and read in the Pre-boot phase of the Windows boot process?
**Hint, answer format = _______ and _______
Research: https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/boot-to-uefi-mode-or-legacy-bios-mode?view=windows-11
Answer: BIOS and UEFI

Primer_Boot_Process_9. What is the name of the process that spawns SYSTEM?
Research: https://en.wikipedia.org/wiki/Windows_NT_booting_process (Hint: What really is SYSTEM?)
Answer: Ntoskrnl.exe

Primer_Boot_Process_10. In Windows what does the boot sector code load into memory?
**Hint - Flag Format = ________ and ________
(Hint: What two things are between the MBR and the Kernel?) Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/performance/windows-boot-issues-troubleshooting
Answer ??????????????????????????????????????????????????????????

Primer_Boot_Process_11. In Windows 10 what is the name of the boot manager?
Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/performance/windows-boot-issues-troubleshooting
Answer: BOOTMGR

Primer_Boot_Process_12. In Microsoft Vista and later the boot.ini file was replaced by what?
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/boot-options-in-windows
Answer: BCD

Primer_Boot_Process_13. What is the tamper-resistant processor mounted on the motherboard used to improve the security of your PC. It's used by services like BitLocker drive encryption and Windows Hello to securely create and store cryptographic keys, and to confirm that the operating system and firmware on your device are what they're supposed to be, and haven't been tampered with.
Research: https://learn.microsoft.com/en-us/windows/security/information-protection/tpm/tpm-fundamentals
Answer: TPM (Trusted Platform Module)

Primer_Boot_Process_14. During the Windows boot process, what starts BOOT_START device drivers and services with value of 0x0 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
Research: https://www.lifewire.com/what-is-winload-exe-2626051
Answer: Winload.exe

Primer_Boot_Process_15. During the Windows boot process, what starts SYSTEM_START device drivers and services with hex value of 0x1 in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
Research: https://en.wikipedia.org/wiki/Ntoskrnl.exe
Answer: ntoskrnl.exe

Primer_Boot_Process_16. During the Windows boot process, services.exe starts device drivers and services on demand with what hex value in the registry key HKLM\SYSTEM\CurrentControlSet\Services?
    hint syntax - #x#
Research: https://winreg-kb.readthedocs.io/en/latest/sources/system-keys/Services-and-drivers.html
Answer: 0x2

Primer_Boot_Process_17. Starting in Windows Vista, what process spawns two additional instances (with identical names), used to initiate session 0 and session 1?
Research: https://www.ghacks.net/2007/12/27/csrssexe-smssexe-and-lsassexe/ https://techcommunity.microsoft.com/t5/ask-the-performance-team/sessions-desktops-and-windows-stations/ba-p/372473
Answer: smss.exe

Primer_Boot_Process_18. Which Windows Vista user session is non-interactive, contains system services and processes and is isolated from the GDI (Graphical Device Interface)

Research: https://techcommunity.microsoft.com/t5/ask-the-performance-team/sessions-desktops-and-windows-stations/ba-p/372473

Answer: session 0

Primer_Boot_Process_19. What is the boot process security feature available in UEFI systems, that only allows verified drivers to load?
Research: https://learn.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-secure-boot
Answer: secure boot

Primer_Boot_Process_20. To make booting faster, starting with Windows 8, the OS does a partial ________ of the kernel session at shutdown?
Research: https://learn.microsoft.com/en-us/windows/win32/power/system-power-states
Answer: hibernate

Primer_Boot_Process_21. What registry key is responsible for starting services on your machine during the boot process? Flag is the full registry path.
Research: https://www.picussecurity.com/resource/blog/picus-10-critical-mitre-attck-techniques-t1060-registry-run-keys-startup-folder
Answer: HKLM\Software\Microsoft\Windows\CurrentVersion\RunServices

Primer_Boot_Process_22. When a user logons to a Windows host, authentication will either grant the user access to the local computer only (Local Logon) or the user will also be granted access to a Windows domain (Domain Logon). Which logon will the user be authenticated via the Security Accounts Manager (SAM) database?
Research: https://learn.microsoft.com/en-us/windows-server/security/windows-authentication/windows-logon-scenarios
Answer: local

Primer_Boot_Process_23. What is the parent process of explorer.exe?
Research: https://en.wikipedia.org/wiki/Windows_NT_booting_process#Shell
Answer: USERINIT.exe 

Primer_Boot_Process_24. What is responsible for handling Windows SAS (secure attention sequence), user profile loading, assignment of security to user shell, and Windows station and desktop protection?
Research: https://learn.microsoft.com/en-us/windows/win32/secauthn/winlogon
Answer: Winlogon

Primer_Boot_Process_25. What critical Windows process is initialized by wininit.exe, is responsible for creating the user's security access token and verifying user logon credentials?
Research: https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service
Answer: LSASS (Local Security Authority Subsystem Service)

Primer_Boot_Process_26. What Microsoft recovery option overwrites the registry key HKLM\System\Select after every successful logon?
Research: https://learn.microsoft.com/en-us/troubleshoot/azure/virtual-machines/start-vm-last-known-good
Answer: ??????????????????????????????????????????????????????????????????????????????????????

Primer_Boot_Process_27. What authentication protocol is the default for logging onto an Active Directory domain and features SSO (Single-Sign On), mutual authentication and primarily uses symmetric cryptography?
Research: https://learn.microsoft.com/en-us/windows-server/security/kerberos/kerberos-authentication-overview
Answer: kerberos

Primer_Boot_Process_28. In Kerberos the Active Directory controller serves as which major Kerberos component consisting of the Authentication Service (AS) and the Ticket Granting Service (TGS)
Research: https://learn.microsoft.com/en-us/windows/win32/secauthn/key-distribution-center
Answer: KDC (Key Distribution Center)

Primer_Boot_Process_29. When would the following Windows registry keys, actions occur? HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell HKLM\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify
Research: https://www.picussecurity.com/resource/blog/picus-10-critical-mitre-attck-techniques-t1060-registry-run-keys-startup-folder
Answer: logon

Primer_Kernel_1. The Windows NT Operating System attempts to combine features and benefits of microkernel and monolithic kernel architectures, making it which type of kernel architecture?
Research: https://www.educative.io/answers/what-is-windows-kernel
Answer: hybrid

Primer_Kernel_2. The Linux kernel is an example of a this type of kernel architecture?
Research: https://simple.wikipedia.org/wiki/Kernel_(computer_science)
Answer: 






Windows_Boot_Remediate_1. The system is booting into safe mode. Identify the flag from the command-line output of the command used to diagnose boot issues.
Follow these instructions to boot the virtual image -- Click Here ---> Windows Bootkit Instructions
run bcdedit and read the discription of the boot loader
Answer: 1RF5Zgf9P

Windows_Boot_Remediate_2. The system is booting into safe mode. Correct that, and reboot into the desktop. The flag is on the desktop.
Follow these Windows Bootkit Instructions to boot the virtual image

Windows_Boot_Remediate_2. The system is booting into safe mode. Correct that, and reboot into the desktop. The flag is on the desktop.
Follow these Windows Bootkit Instructions to boot the virtual image
use msconfig to turn off safe mode

Windows_Boot_Remediate_3. Prevent the system restart using the command line, and then identify persistence mechanisms that are reverting the OS and boot loader configurations.
The flag is in the same folder as the persistence mechanism.
HINT: Copy the error message in its entirety to figure out what is happening to the system.
WARNING: You have 30 seconds to comply.
Follow these Windows Bootkit Instructions to boot the virtual image




Primer_Processes_3. What is the full path to folder used when Windows redirects 32 bit applications running on a 64bit system?
Research: https://learn.microsoft.com/en-us/windows/win32/winprog64/file-system-redirector
Answer: C:\Windows\SysWOW64

Primer_Processes_4. What Windows System Service starts the kernel and user mode subsystems?
Research: https://en.wikipedia.org/wiki/Session_Manager_Subsystem
Answer: smss.exe

Primer_Processes_5. What Windows system process:
    Runs in session 0
    is responsible for enforcing the security policy on the system
    Performs all logon functions
    Handles password changes
    Creates access tokens
    Writes to the Windows Security Log
Research: https://en.wikipedia.org/wiki/Local_Security_Authority_Subsystem_Service
Answer: LSASS

Primer_Processes_6. Which is spoolsv.exe?
Server-mode service or User-mode service
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/print/introduction-to-spooler-components
Answer: Server-mode service

Primer_Processes_7. Which service type is explorer.exe?
Server-mode service or  User-mode service
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/gettingstarted/user-mode-and-kernel-mode https://en.wikipedia.org/wiki/File_Explorer
Answer: User-mode service

Primer_Processes_8. During a network survey you observed a host running inetinfo.exe service. What type of server might you have found?
Research: https://www.file.net/process/inetinfo.exe.html
Answer: Microsoft Internet Information Services (IIS)

Primer_Processes_9. During a reconnaissance mission you enumerated a host running the dns.exe service. Is this a user pc or a server?
user pc or server
Research: https://learn.microsoft.com/en-us/windows-server/networking/dns/dns-top
Answer: Server

Primer_Processes_10. A host running firefox and office 365 is most likely what type of host? Server or Client
Research: https://www.heavy.ai/technical-glossary/client-server
Answer: Client

Primer_Processes_11. How does a User-Mode Service request resources?
Research:https://www.educative.io/answers/what-is-user-mode-vs-kernel-mode-in-an-operating-system
Answer: System Calls

Primer_Processes_12. Passively copying currently running processes for comparison later is known as?
Research: https://isc.sans.edu/diary/Baselining+Servers+to+Detect+Outliers/22940 https://www.sciencedirect.com/topics/computer-science/passive-fingerprinting
Answer: baselining

Primer_Processes_1. What part of the process executes?
Research: https://learn.microsoft.com/en-us/windows/win32/procthread/processes-and-threads
Answer: thread

Primer_Processes_2. Windows has how many process priority levels?
Research: https://learn.microsoft.com/en-us/windows/win32/procthread/scheduling-priorities
Answer: 32

Windows_Processes_Basics_1. What Sysinternals tool shows malware persistence locations in tabs within its GUI?
ANswer: autoruns

Windows_Processes_Basics_2. What Sysinternals tool is used to investigate processes?
Answer: Process Explorer

Windows_Processes_Basics_3. What Sysinternals tool can be used to investigate network connection attempts?
Answer: TCPView

Windows_Processes_Basics_4. What Sysinternals tool can view permissions?
Answer: AccessChk

Windows_Processes_Basics_5. What Sysinternals tool allows us to view and modify handles?
Answer: Handle

Windows_Processes_Basics_6. What is the default Windows user directory for files downloaded from the internet? The flag is the folder name only.
Answer: Downloads

Windows_Processes_Basics_7. What is the default Windows download directory that everyone has access to? The flag is the absolute path to the directory.
Answer: C:\Users\Public\Downloads

Windows_Processes_Basics_8. What Sysinternals tool shows service load order?
Answer: LoadOrder

Windows_Processes_Basics_9. What is the service name of Windows Defender Firewall?
Answer: mpssvc

Windows_Processes_Basics_10. What SysInternals tool reports .dlls loaded into processes?
Answer: ListDLLs

Windows_Hidden_Processes_1. There is malware on the system that is named similarly to a legitimate Windows executable. There is a .dll in the folder that the malware runs from. The flag is the name of the .dll.
Answer: 

Windows_Hidden_Processes_3. Determine what is sending out a SYN_SENT message. The flag is the name of the executable.
HINT: Use a Sysinternals tool.
Use TCPView and look under the state columb for SYN_SENT
Answer: McAfeeFireTray.exe

Win_Process_Situational_Awareness_5. While examining the Windows Defender Firewall, what is the LogAllowedConnections setting set to, for the Public profile?
Get-NetFirewallProfile -Profile Public | Select-Object -ExpandProperty LogAllowedConnections
Answer: False

Win_Process_Situational_Awareness_1. What are the permissions for NT SERVICE\TrustedInstaller on spoolsv.exe? Copy the permissions from your shell.
HINT: Use Sysinternals tools.
Or by using CMD...
C:\Windows\System32\spoolsv.exe
icacls C:\Windows\System32\spoolsv.exe
NT SERVICE\TrustedInstaller:(F)
BUILTIN\Administrators:(RX)
NT AUTHORITY\SYSTEM:(RX)
BUILTIN\Users:(RX)
APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(RX)
APPLICATION PACKAGE AUTHORITY\ALL RESTRICTED APPLICATION PACKAGES:(RX)
Successfully processed 1 files; Failed processing 0 files 
Answer: full "(F)"

Windows_Hidden_Processes_6. Find the McAfeeFireTray.exe. There is a file in that directory. The flag is inside.
HINT: Use Sysinternals tools.
Get-ChildItem -Path C:\ -Filter "McAfeeFireTray.exe" -File -Recurse -ErrorAction SilentlyContinue | Select-Object -ExpandProperty FullName  
C:\Program Files\Windows Defender Advanced Threat Protection\McAfeeFireTray.exe 
Find a file called "It's_Here"
Answer: StrongBad

Win_Process_Situational_Awareness_4. What is the first .dll associated with winlogon.exe? Provide the name of the .dll only, not the /absolute/path
HINT: Use Sysinternals tools.
Find winlogon.exe in process explorer
check properties and threads, look for the dll with the lowest TID (thread ID)
ntdll.dll!RtlUserThreadStart+0x21
Answer: ntdll.dll

***strings***


Windows UAC

Windows_UAC_Basics_1. What Sysinternals tool will allow you to view a file's manifest?
Answer: sigcheck

Windows_UAC_Basics_2. What is the RequestedExecutionLevel for an application to run with the same permissions as the process that started it?
Answer: asInvoker

Windows_UAC_Basics_3. What RequestedExecutionLevel will prompt the user for Administrator credentials if they're not a member of the Administrator's group?
Answer: requireAdministrator

Windows_UAC_Basics_5. What registry key holds UAC values?
Answer: HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System

Windows_UAC_Basics_4. The flag is the RequestedExecutionLevel of the schtasks.exe file.
PS C:\Users\andy.dwyer\Downloads> .\sigcheck.exe -m -accepteula C:\Windows\System32\schtasks.exe  
<trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
<security>
<requestedPrivileges>
<requestedExecutionLevel
level="asInvoker"
uiAccess="false"
Answer: asInvoker

Windows_UAC_Basics_6. Determine which UAC subkey property shows whether UAC is enabled or not. The flag is the data value in that property.
Hint: Make sure you're on the correct box.
REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System
EnableLUA    REG_DWORD    0x1337  
Answer: 0x1337

Windows_UAC_Basics_7. Provide the name of the UAC [Registry subkey] property that determines what level UAC is set to for admin privileges (Example UAC levels: Default, Always, Notify).
Answer: ConsentPromptBehaviorAdmin

Windows_UAC_Basics_8. Query the registry subkey where UAC settings are stored, and provide the flag.
PS HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies>  ls
Answer: NiceJob





Windows Services

Windows_Services_Basics_1.What command-line (cmd) command will show service information?
Answer: sc query

Windows_Services_Basics_2. What command-line (cmd) command will show all services, running or not running?
The flag is the full command, for all services.
Answer: sc query state=all

Windows_Services_Basics_3. What PowerShell command will list all services?
Answer: Get-Service

Windows_Services_Basics_4. What registry location holds all service data?
Answer: HKLM\SYSTEM\CurrentControlSet\Services

Windows_Services_Basics_5. What registry subkey holds a service's .dll location?
The flag is the subkey name (full path not needed).
Answer: parameters

Windows_Services_Basics_6. Services have a name and display name, which could be different. What is the service name of the only Totally-Legit service?
Get-Service -Name "Totally-Legit"
Status   Name               DisplayName  
------   ----               -----------
Stopped  Legit              Totally-Legit  
Answer: Legit

Windows_Services_Basics_7. Figure out the SID of the only Totally-Legit service.
Example: S-1-5-80-159957745-2084983471-2137709666-960844832-[1182961511]
Submit only the [bracketed] portion of the SID.
HINT: Run the command on the service name, not the display name.
in cmd
sc showsid legit
NAME: legit
SERVICE SID: S-1-5-80-159957745-2084983471-2137709666-960844832-1182961511
STATUS: Inactive   
Answer: 1182961511


Linux Process Validity

Linux Processes 1. What is the process ID (PID) of the SysV Init daemon?
pidof init
Answer: 1

Linux Processes 2. How many child processes did SysV Init daemon spawn?
bombadil@minas-tirith:~$ pstree -p 1
init(1)─┬─cgmanager(1276)
        ├─cron(1326)───cron(21925)───sh(21942)───camlindon(21955)───camlindon(21965)───sleep(22134)
        ├─dbus-daemon(1381)
        ├─dhclient(1072)
        ├─dhclient(1107)
        ├─getty(2347)
        ├─getty(2348)
        ├─getty(2349)
        ├─getty(2350)
        ├─getty(2351)
        ├─getty(2352)
        ├─irqbalance(1416)
        ├─netcat(2354)
        ├─nscd(1256)
        ├─ntpd(1458)───{ntpd}(1480)
        ├─orphan(22122)
        ├─orphan(22123)
        ├─orphan(22124)
        ├─orphan(22125)
        ├─rsyslogd(1280)─┬─{in:imklog}(1282)
        │                ├─{in:imuxsock}(1281)
        │                └─{rs:main Q:Reg}(1283)
        ├─sauron(2353)
        ├─sshd(2155)───sshd(21437)───sshd(21456)───bash(21459)───pstree(22135)
        ├─systemd-logind(28002)
        └─systemd-udevd(365)
Answer: 24

Linux Processes 3. Identify all of the arguments given to the ntpd daemon (service) using ps.
Format: List all options with parameters (include numbers).
bombadil@minas-tirith:/$ ps -elf | grep ntpd
5 S ntp       1458     1  0  80   0 - 23949 -      May23 ?        00:01:00 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -u 105:109
0 S bombadil 30969 21459  0  80   0 -  3179 -      19:18 pts/0    00:00:00 grep ntpd     
Answer: -p /var/run/ntpd.pid -g -u 105:109

Linux Processes 4. What is the parent process to Bombadil’s Bash process? (name of the binary, not the absolute path)
bombadil@minas-tirith:~$ ps -o ppid= -p $$
# echo $$ gives the PID of the currently running bash shell
21456
bombadil@minas-tirith:~$ ps -p 21456 -f
UID        PID  PPID  C STIME TTY          TIME CMD
bombadil 21456 21437  0 17:04 ?        00:00:00 sshd: bombadil@pts/0
Answer: sshd

Linux Processes 5. Identify the file mapped to the fourth file descriptor (handle) of the cron process.
HINT: There might be multiple cron processes, but only one with the answer.
Flag format: /absolute/path
$ sudo lsof -c cron 
Answer: /run/chron.pid (I have no idea why this is the right answer)

Linux Processes 6. Identify the permissions that cron has on the file identified in Processes 5.
HINT: Read the man page for lsof to understand permissions.
Flag format: If more than one, list the permissions comma separated, no spaces
bombadil@minas-tirith:/run$ ls -lisa crond.pid
11244 4 -rw-r--r-- 1 root root 5 May 23 17:55 crond.pid  
Answer: r,w

Linux Processes 7. Identify the names of the orphan processes on the SysV system.
NOTE: Remember, orphan processes spawn and die periodically. Try monitoring the processes list with top or htop to find them.
Flag format: in alphabetical order with all non-alphabetic characters removed: Name,Name,Name,Name
HINT: Only character names!
run HTOP and look for PPID 1, get the names of the orphans
Answer: Aragorn,BruceWayne,Eowyn,Tolkien

Linux Processes 8. Locate zombie processes on the SysV system.
Identify the zombie processes' parent process.
NOTE: Remember, zombie processes only live until the parent process kills and removes them from the system’s process table. Try monitoring the processes list with top or htop to find them.
Flag format: /absolute/path
Run HTOP and look for the Z status
Check the PPID and run ps -p <PPID> -o comm=
funk
which funk
Answer: /bin/funk

Linux Processes 9. Locate the strange open port on the SysV system.
Identify the command line executable and its arguments.
Flag format: /executable/path -arguments
run netstat -tuln to look for and weird port activity (we see 1234 open)
monitor HTOP to see if anything comes up
see that someone is running netcat to open a port
get the PID and run the following to get more inforamtion about it
bombadil@minas-tirith:/proc$ ps -p 2354 -o pid,ppid,cmd,%cpu,%mem --no-headers && readlink -f /proc/2354/exe
2354     1 /bin/netcat -lp 9999         0.0  0.0 
Answer: /bin/netcat -lp 9999

Linux Process Proc Dir 1. Examine the process list to find the ssh process. Then, identify the symbolic link to the absolute path for its executable in the /proc directory.
The flag is the absolute path to the symbolic link, and the file it is linked to.
Flag format: /absolute/path,/absolute/path
Monitor HTOP and look for sshd, not the process
run
sudo ls -l /proc/<IPD>
look for the "-->" to annotate a link
Answer: /proc/2155/exe,/usr/sbin/sshd

Linux Process Proc Dir 2. Identify the file that contains udp connection information. Identify the process using port 123.
For the flag, enter:
    Process name
    File descriptor number for the udp socket
    Its permissions as shown in lsof
Flag format: name,#,permission
Figure out what is using UDP port 123
sudo lsof -i UDP:123
ntpd
sudo lsof | grep ntpd
ntpd       1458             ntp   19u     IPv4              12333      0t0        UDP 10.3.0.7:ntp 
ntpd = process name
19 = file descriptor
lsof permission = u
Answer: ntpd,19,u

Linux Processes 10. Locate the strange open port on the SysV system.
Identify how the process persists between reboots.
The flag is the absolute path for the file that contains the persistence mechanism, and the configuration option.
HINT: Persistence is defined here
Flag format: filepath,configuration_option

Linux Processes 10. Locate the strange open port on the SysV system.
Identify how the process persists between reboots.
The flag is the absolute path for the file that contains the persistence mechanism, and the configuration option.
HINT: Persistence is defined here
Flag format: filepath,configuration_option
find all of the processes
ps -aux
see that netcat is running
figure out that the ppid is 1, meaning that it is run from init
grep -R netcat 
/etc/inittab:91:2345:respawn:/bin/netcat -lp 9999
Answer: /etc/inittab,91:2345:respawn:/bin/netcat -lp 9999

Linux Process Proc Dir 3. Identify one of the human-readable file handles by the other program that creates a zombie process.
NOTE: Remember, zombie processes only live until the parent process kills them. Try monitoring the processes list with top or htop to find them.
The flag is the text from one of the files it reads.
Monitor HTOP for any zombie processes, once one comes up, run
sudo lsof -p PID
look for a file that you can cat
cat /opt/mysoul
Answer: and in the darkness bind them


Windows Auditing and Logging

Primer_Auditing_1. Logging, Auditing and Monitoring are often confused with each other but are distinctly different. Which term refers to real-time analysis and is often accomplished with a Security Event Information Management system (SIEM)?
Answer: Monitoring

Primer_Auditing_2. What term is most appropriate when referring to the process of reviewing log files or other records for specified period?
Answer: Auditing

Primer_Auditing_3. "Complete the following path to the Windows System Log which records system events e.g. startup and shutdown: %systemroot%\System32_______________
C:\Windows\System32\Winevt\Logs\System.evtx
Answer: \Winevt\Logs\System.evtx

Primer_Auditing_4. Which Windows log contains either success or failures and can be configured to record failed logon attempts?
C:\Windows\System32\Winevt\Logs\Security.evtx
Answer: Security

Primer_Auditing_5. "Which Windows account is the only account to have WRITE-APPEND access to Windows event logs?"
Resource: https://os.cybbh.io/public/os/latest/011_windows_auditing_&_logging/primer.html#_7_describe_the_systems_audit_policy
In order to access the audit policy in the registry you must have or elevate your privileges to the Local System account NT AUTHORITY\SYSTEM.
Answer: System

Primer_Auditing_6.What is parsed in an NTFS object's security descriptor, by the Security Reference Monitor (SRM), to determine if an audit entry will be created in the Windows Security Log?
Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists
In an NTFS object's security descriptor, the Security Reference Monitor (SRM) parses the "System Access Control List" (SACL) to determine if an audit entry will be created in the Windows Security Log. The SACL contains the access control entries (ACEs) that define the auditing settings for the object.
The SACL specifies which security events should be audited for the object, such as successful or failed access attempts, modifications, deletions, or other relevant actions. When a security event occurs on an object, the SRM checks the SACL to determine if auditing is enabled for that event. If auditing is enabled, an audit entry is created in the Windows Security Log, which can then be reviewed for security analysis and monitoring purposes.
Answer: SACL

Primer_Auditing_7. Which registry key holds the audit policy configuration? **Hint - Give full path
Answer: HKLM\SECURITY\Policy\PolAdtEv

Primer_Auditing_8. Which sysinternals tool is used to parse logs?
Answer: PsLogList

Windows_Recent_Files_1. What is the registry location of recent docs for the current user?
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs

Windows_Bam_1. Challenge only allows ONE attempt
BAM settings are stored in different registry locations based on the version of Windows 10. What version of Windows 10 is workstation2 running? The answer is the 4 digit Windows 10 release (version) number.
(Get-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion" -Name "ReleaseId").ReleaseId
Answer: 1803

Windows_Last_Access. Figure out the last access time of the hosts file.
Flag format: mm/dd/yyyy
PS C:\Windows\System32> (Get-Item -Path "C:\Windows\System32\drivers\etc\hosts").LastAccessTime 
Tuesday, May 23, 2023 7:32:23 PM  
Answer: 05/23/2023

Windows_Prefetch_1. What is the literal path of the prefetch directory?
Answer: C:\Windows\Prefetch

Windows_Recycle_Bin_1. In the Recycle Bin, there is a file that contains the actual contents of the recycled file. What are the first two characters of this filename?

Windows_UserAssist_1. What are the first 8 characters of the Globally Unique Identifier (GUID) used to list applications found in the UserAssist registry key (Windows 7 and later)?
Answer: CEBFF5CD

Windows_UserAssist_2. What cipher method are UserAssist files encoded in?
Most commonly enciphered using XOR but...
Answer: ROT13

Windows_Logs_1. What main Windows log would show invalid login attempts?
Answer: Security

Windows_Logs_2. What main Windows log will show whether Windows updates were applied recently?
Answer: System

Windows_Logs_3. When reading logs, you may notice ... at the end of the line where the message is truncated. What format-table switch/argument will display the entire output?
Flag format: -argument
-AutoSize is one way to do it
Answer: -Wrap

Windows_Recent_Files_2. There is a file that was recently opened that may contain PII.
Get the flag from the contents of the file.
Hint: We're not interested in numbers.
I didn't find this using the method they wanted. 
PS C:\> Get-ChildItem 'C:\$recycle.bin' -Recurse -Verbose -Force | select FullName
wmic useraccount where 'sid="S-1-5-21-2881336348-3190591231-4063445930-1003"' get name
Name
student 
PS C:\> Get-Content 'C:\$Recycle.Bin\S-1-5-21-2881336348-3190591231-4063445930-1003\*.txt'  
PS C:\> Get-Content 'C:\$Recycle.Bin\S-1-5-21-2881336348-3190591231-4063445930-1003\$I*.txt' 
PS C:\> Get-Content 'C:\$Recycle.Bin\S-1-5-21-2881336348-3190591231-4063445930-1003\$I2*.txt' 
What's going on in the directory revealed by this search?
PS C:\> cat .\Users\student\Documents\* 
Flag, Found A.  1 1 4 - 3 4 - 2 5 4 7          4 8 3 - 5 1 4 - 9 4 3 1 
Answer: Flag, Found A.

Windows_Prefetch_2. Enter the name of the questionable file in the prefetch folder.
PS C:\> Get-ChildItem -Path 'C:\Windows\Prefetch\'    
Answer: BAD_INTENTIONS.EXE-8F2806FC.pf 

Windows_Logs_4. Check event logs for a flag string.
Machine: file-server
Get sysinternals
PS C:\Users\andy.dwyer\Desktop> $wc = new-object System.Net.WebClient 
PS C:\Users\andy.dwyer\Desktop> $wc.DownloadFile("https://download.sysinternals.com/files/SysinternalsSuite.zip",
"$pwd\SysinternalsSuite.zip") 
PS C:\Users\andy.dwyer\Desktop> Expand-Archive SysinternalsSuite.zip
navigate into the sysinternals directory
.\strings.exe C:\Windows\System32\winevt\Logs\*.evtx | Select-String "flag"   
let this shit run until it completes
C:\Windows\System32\winevt\Logs\System.evtx: ......................the Flag is: 3v3nt_L0g 
Answer: 3v3nt_L0g

Windows_Browser_Artifacts_1. What Sysinternals tool will allow you to read the SQLite3 database containing the web history of chrome?
Answer: strings.exe

Windows_Browser_Artifacts_2. Find the questionable website that a user browsed to (using Chrome), that appears to be malicious. *Note: There are more than one users on the box.
Machine: Workstation2 (ssh from Admin_Station)
First, get sysinternals onto workstation2
PS C:\Users\andy.dwyer\Desktop> scp -p C:\Users\Public\Desktop\SysinternalsSuite.zip andy.dwyer@10.3.0.4:/C:\Users\andy.dwyer\Downloads\
then navigate over to the sysinternalssuite

Windows_Recycle_Bin_3. Recover the flag from the Recycle Bin. Enter the name of the recycle bin file that contained the contents of the flag, and the contents of the deleted file.
Flag format: filename,contents
cmd
cd C:\Recycle.Bin
Powershell
gci -Recurse -Verbose -Force *$r* | foreach-object {$_.Name, (get-content $_.FullName)}
Answer: $R8SR72C.txt,DontTrashMeyo 


Linux Auditing

Linux Auditing and Logging XML 1.File: /home/garviel/output.xml
Identify the XML element name in the output below
<scaninfo type="syn" protocol="tcp" numservices="200" services="1-200"/>
Flag: The element, with start and end tags
Answer: <scaninfo/>

Linux Auditing and Logging XML 2. Identify one of the XML attributes in the output below
<scaninfo type="syn" protocol="tcp" numservices="200" services="1-200"/>
Flag format: value="pair"
Answer: type="syn"

Linux Auditing and Logging Standards 1. What RFC is Syslog?
Answer: 5424

Linux Auditing and Logging Standards 2. Challenge only allows 3 attempts
What is the numerical code assigned to the facility dealing with authorization?
Numerical Code 	Facility
0  kernel messages
1  user-level messages
2  mail system
3  system daemons
4  security/authorization messages
5  messages made by syslogd
6  line printer subsystem
7  network news subsystem
Answer: 4

Linux Auditing and Logging Standards 3. Challenge only allows 3 attempts
How many severity codes are defined in the standard that defines syslog?
Numerical Code 	Severity
0  Emergency
1  Alert
2  Critical
3  Error
4  Warning
5  Notice
6  Informational
7  Debug
Answer: 8

Linux Auditing and Logging Standards 4. Challenge only allows 3 attempts
What severity is assigned to system instability messages?
Hint: Use the numerical code!
Answer: 0

Linux Auditing and Logging Syslog 1. Challenge only allows 3 attempts
Download the attached rsyslog configuration file for the Syslog # challenges.
In the legacy rules section of the file, what facility is logged to 0.log?
#Legacy rules. Why do we even have these?
#
0.* -/var/log/0.log 
    Selectors 	                 Action
facility. severity       /path/to/log/location
Answer: 0

Linux Auditing and Logging Syslog 2. Challenge only allows 3 attempts
In the legacy rules section of the file, how many severities are logged to 0.log?
Flag: Total number of severities
Answer: 8

Linux Auditing and Logging Syslog 3. In the legacy rules section of the file, how many severities are logged to 4min.log?
List the severities from highest severity (lowest numerical listed) to lowest severity (highest numerical listed) using their severity name.
Flag format: name,name,name
4.4 -/var/log/4min.log
Answer: emergency,alert,critical,error,warning

Linux Auditing and Logging Syslog 4. In the legacy rules section of the file, how many severities are logged to 4sig.log?
List the severities from highest severity (lowest numerical listed) to lowest severity (highest numerical listed), using their severity name.
Flag format: name,name,name
Hint: I’m sure they made a man page for this. Read the downloaded file for some links.
Answer: notice,informational,debug

Linux Auditing and Logging Syslog 5. Challenge only allows 3 attempts
What is being logged in not.log?
Provide the facilities from lowest facility to highest facility numerically, and the severity being logged. (List only the first word for each.)
Flag format: facility,facility,facility,severity
Answer:mail,clock,ntp,notice

Linux Auditing and Logging Syslog 6. Challenge only allows 3 attempts
What facilities and what severities are being sent to a remote server over a reliable connection using port 514?
Provide the facility names, number of severities, and the correct destination IP address.
Flag format: F,F,#,IP
Answer: auth,authpriv,8,10.30.0.1

Linux Auditing and Logging Syslog 7. Challenge only allows ONE attempt
Use the answer from Syslog 6 for this question.
Do logs that match this filter ever get saved on the local machine?
Yes
No
/var/log/auth.log exists so...
Answer: yes

Linux Auditing and Logging Syslog 8. What messages are being sent to 10.84.0.1?
Provide the facility number, the number (amount) of severity codes, and Layer 4 connection type as the answer.
Flag format: F,S,Layer 4 connection Type
0,7,udp

Linux Auditing and Logging XML 3. File: /home/garviel/output.xml
Parse all of the IP addresses from the file using XPATH queries
https://www.w3schools.com/xml/xpath_intro.asp
HINT:
    http://xpather.com/
    http://www.whitebeam.org/library/guide/TechNotes/xpathtestbed.rhtm
Sample Output (without piping to MD5SUM)
 addr="XXX.xxx.xxx.xxx"
 addr="XXX.xxx.xxx.xxx"
 addr="XXX.xxx.xxx.xxx"
 addr="XXX.xxx.xxx.xxx"
 addr="XXX.xxx.xxx.xxx"
 addr="XXX.xxx.xxx.xxx"
--TRIMMED--
Flag format: md5 hash of output
garviel@terra:~$ xpath -q -e '//address/@addr' output.xml | md5sum
Answer: 0e850f14fc192c5105955ec094287bd2 

Linux Auditing and Logging XML 4. File: /home/garviel/output.xml
    Select all of the IP addresses and ports using a single XPATH Union Statement
    Pipe the result to md5sum for the flag
HINT:
    https://librarycarpentry.org/lc-webscraping/02-xpath/index.html
Sample Output (without piping to MD5SUM)
 addr="xx.xxx.xx.xx"
 addr="xx.xxx.xx.xx"
 addr="xx.xxx.xx.xx"
 addr="xx.xxx.xx.xx"
 portid="xx"
 addr="10.50.29.6"
 addr="xx.xxx.xx.xx"
 portid="22"
--TRIMMED--
garviel@terra:~$ xpath -q -e '//address/@addr | //@portid' output.xml | md5sum
Answer: ff7990139b6d09aa65afb6e069db0dec 

Linux Auditing and Logging JSON 1. File: /home/garviel/conn.log
    Use jq to pretty print the JSON file conn.log.
    Hash the pretty-printed file with md5sum for the flag.
Sample JSON "Pretty Print" Output (without piping to MD5SUM)
  "ts": 1615383120.585641,
  "uid": "C9ybUDHykHdrh0h93",
  "id.orig_h": "10.50.24.73",
  "id.orig_p": 38156,
  "id.resp_h": "192.168.65.20",
  "id.resp_p": 443,
  "proto": "tcp",
  "duration": 2.8133392333984375e-05,
  "orig_bytes": 0,
  "resp_bytes": 0,
HINT:
    https://jqplay.org/
    https://docs.jsonata.org/simple
    https://stedolan.github.io/jq/manual/
garviel@terra:~$ cat conn.log | jq . | md5sum
Answer: 25ebedf7442e470eaaa48b5f7d5b96f4

Linux Auditing and Logging JSON 2. File : /home/garviel/conn.log
This file is a conn.log made in Zeek (Bro) with data about TCP/IP connections.
Use jq to locate and count the unique originating endpoint IP addresses in the file. Enter the number of unique originating IP addresses as the flag.
Flag format: #
HINT: Use this link to understand the JSON object’s attributes
garviel@terra:~$ jq '."id.orig_h"' conn.log | sort | uniq | wc -l
Answer: 31

Linux Auditing and Logging JSON 3. File: /home/garviel/conn.log
This file is a conn.log made in Zeek (Bro) with data about TCP/IP connections.
Use jq to locate and count connections where the destination IP sent more than 40 bytes to the source IP.
Flag format: #
garviel@terra:~$ jq '."resp_ip_bytes" > 40' conn.log | grep "true" | wc -l
Answer: 177

Linux Auditing and Logging Whut 1. Use the log file attached to this for all Whut questions.
How many unique users logged into this machine?
$ cat log.txt | grep "logind"
Answer: 3


Linux Auditing and Logging XML 5. File: /home/garviel/output.xml
    Select every IP address with open (in use) ports using XPATH queries and XPATH axes.
    Pipe the result to md5sum for the flag
Sample Output (without piping to MD5SUM)
 addr="10.50.29.5"
 portid="xx"
 addr="xx.xx.xx.xx"
 portid="xx"
--TRIMMED--
garviel@terra:~$ xpath -q -e "//host/ports/port/state[@state='open']/../../../address/@addr | //host/ports/port/state[@state='open']/../../port/@portid" output.xml | md5sum
Answer: 9bda6beaf7da647f4155195885a10e5c 












Memory Analysis


Primer_Networking_1. What is used in Windows to implement the networking stack to enable communication with the four lowest OSI layers?
Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc958797(v=technet.10)?redirectedfrom=MSDN
Answer: NDIS (Network Driver Interface Specification)

Primer_Networking_2. What Windows cmd.exe command will display the local coputer's routing table?
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/netstat
Answer: netstat -r

Primer_Networking_3. IANA assigned TCP/UDP ports in the range of 0-1023 that are usually associated with server-side services are known as?
Research: https://networkencyclopedia.com/well-known-port-numbers/
Answer: well-known ports

Primer_Networking_4. What term describes randomly assigned TCP/UDP ports above 1023 and are used for a short period of time (for the duration of a communication session}?
Research: https://en.wikipedia.org/wiki/Ephemeral_port
Answer: ephemeral

Primer_Networking_5. The two words that decribe translating Host names to IP addresses or NetBIOS names to IP addresses is_____?
Research: https://learn.microsoft.com/en-us/windows/win32/dns/name-resolution
Answer: Name Resolution

Primer_Networking_6. What is the hierarchical service/protocol that translates hostnames to IP addresses?
Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview
Answer: DNS

Primer_Security_1. What is the term for the numeric value that the Windows OS uses to uniquely ID a user, group or computer?
Answer: SID

Primer_Security_2. What switch can be added to the CMD.exe command whoami, to view the SID of the current user?
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/whoami
Answer: /all

Primer_Security_3. What is the value of a Relative Identifier (RID) assigned to the 1st user account?
Research: https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_4_associate_a_user_sid_with_a_user_profile
Answer: 1000

Primer_Security_4. What is the well known RID for the Windows Built-In Administrator Local account?
Research: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/81d92bba-d22b-4a8c-908a-554ab29148ab
Answer: 500

Primer_Security_5. Complete the GET_CimInstance cmdlet to view all the user SIDs on a Windows host machine by Name and SID respectively:
Get-CimInstance Win32_UserAccount | Select-Obect ______________
**hint: the output will ONLY include Name and SID
Answer: Name,SID

Primer_Security_6. In Windows what else does a user's security Token contain?
    SIDS of groups of which the user is a member
    Privilege array
    The Users _________ ?
**hint: Flag describes the unique number assigned to the user
Research: https://os.cybbh.io/public/os/latest/013_memory_analysis/primer.html#_1_1_security_identifiers_sids
Answer: SID

Primer_Security_7. When contained in a Windows users access token, what privilege does SeBackupPrivilege grant to the user to perform on files and folders?
**hint - flag is one word
Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/ifs/privileges
Answer: Backup

Primer_Security_8. Windows performs mandatory integrity checks (MICs) by comparing the integrity level of the resource with the integrity level of the calling process. Windows does this integrity check before the the objects discretionary access check because it is _____________?
Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/mandatory-integrity-control
Hint: Opposite of slower
Answer: faster

Primer_Security_9. A Windows object's Security _________ contains:
    The SID of the object's owner
    Discretionary Access Control List (DACL)
    System Access Control List (SACL)
Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/security-descriptors
Answer: Descriptor

Primer_Security_10. What contains Access Control Entries (ACEs), that define the types of access a user or group may be granted to an object?
Research: https://learn.microsoft.com/en-us/windows/win32/secauthz/access-control-lists
Answer: DACL (discretionary access control list)

Primer_Security_11. What cmdlet gets objects that represent the security descriptor of a file or resource?
Research: https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.security/get-acl?view=powershell-7.2
Answer: Get-ACL

Primer_Security_12. What NET cmd.exe command can be used to enumerate the local Windows group accounts?
Research: https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc725622(v=ws.11)
Answer:  net localgroup

Primer_Security_13. Read and answer
https://ss64.com/nt/icacls.html
What Windows cmd.exe command will display or modify Access Control Lists (ACLs) for files and folders and resolves various issues that occur when using the older CACLS & XCACLS.
Answer: icacls

Primer_Security_14. Read and answer:
https://learn.microsoft.com/en-us/windows/win32/memory/data-execution-prevention
What Windows security feature is a system-level memory protection feature that is built into the operating system starting with Windows XP and Windows Server 2003 and enables the system to mark one or more pages of memory as non-executable?
Answer: DEP (Data Execution Prevention)

Primer_Security_15. What computer security technique is used in Windows to prevent exploitation of memory corruption vulnerabilities? This feature randomly arranges the address space positions of key data areas of a process, in order to prevent an attacker from reliably jumping to, a particular exploited function in memory.
Research: https://www.mandiant.com/resources/blog/six-facts-about-address-space-layout-randomization-on-windows
Answer: ASLR (address space layout randomization)

Primer_Security_16. What is a small kernel-mode library that can implement API hooking?
Research: https://techcommunity.microsoft.com/t5/ask-the-performance-team/demystifying-shims-or-using-the-app-compat-toolkit-to-make-your/ba-p/374947
Answer: shim

Primer_Security_17. Read and Answer the next 4 challenges regarding Windows security features introduced in Windows 10 Creator's Update (Windows 10, version 1703)
https://learn.microsoft.com/en-us/windows/security/threat-protection/overview-of-threat-mitigations-in-windows-10
Which security feature helps keep attackers from gaining access through Pass-the-Hash or Pass-the-Ticket attacks useing virtualization-based security to isolate secrets, such as NTLM password hashes and Kerberos Ticket Granting Tickets?
Answer: Credential Guard

Primer_Security_18. Introduced in Windows 8 this is Microsoft Antivirus, anti-malware solution?
Research: https://www.microsoft.com/en-us/windows/comprehensive-security
Answer: Defender

Primer_Security_19. What security technique helps prevent overwrites of the Structured Exception Handler?
Research: https://support.microsoft.com/en-us/topic/how-to-enable-structured-exception-handling-overwrite-protection-sehop-in-windows-operating-systems-8d4595f7-827f-72ee-8c34-fa8e0fe7b915
Answer: SEHOP (Structured Exception Handling Overwrite Protection)

Primer_Security_20. What security protection is built into Windows 10, as described in the "Memory reservations" item in Kernel pool protections? This includes protecting address space 0x00000000 (not listed in article).
Hint: what is 0? Research: https://learn.microsoft.com/en-us/windows/win32/memory/reserving-and-committing-memory
Answer: null (null dereference)

Primer_Security_21. Read and answer: https://learn.microsoft.com/en-us/windows/win32/wfp/windows-resource-protection-portal
What Windows security feature prevents the replacement of essential system files, folders, and registry keys that are installed as part of the operating system? It became available starting with Windows Server 2008 and Windows Vista.
Answer: WRP (Windows Resource Protection)

Primer_Security_22. Read and answer: https://support.microsoft.com/en-us/topic/use-the-system-file-checker-tool-to-repair-missing-or-corrupted-system-files-79aa86cb-ca52-166a-92a3-966e85d4094e
What option should you use with the System File Checker cmd.exe tool sfc.exe to scan all protected system files, and replace corrupted files with a cached copy that is located in a compressed folder at %WinDir%\System32\dllcache ?
Answer: scannow

Primer_Security_23. Where are copies of known-good critical system files located at %WinDir%___________ and used by the Windows Resource Protection feature?
hint: complete the path
Research: https://en.wikipedia.org/wiki/Windows_Resource_Protection https://learn.microsoft.com/en-us/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder?view=windows-11
Answer: \WinSxS\Backup

Primer_Networking_7. What CLI tool is often used to troubleshoot DNS issues but can also be used in reconnaissance?
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nslookup
Answer: nslookup

Primer_Networking_8. In Windows 10 what is the full path to the hosts file? Complete the path c:\Windows____________
Research: https://www.tenable.com/plugins/nessus/23910
Answer: C:\Windows\System32\drivers\etc\hosts

Primer_Networking_9. Fill in the missing component for the usual Host Name Resolution order:
    Client checks own host name
    Client searches local Hosts file
    ______________________
    NetBIOS name resolution sequence is used as a backup
Flag Format: Full name or acronym
Research: https://learn.microsoft.com/en-us/windows/win32/dns/dns-overview https://support.microsoft.com/en-us/topic/microsoft-tcp-ip-host-name-resolution-order-dae00cc9-7e9c-c0cc-8360-477b99cb978a
Answer: DNS (Domain Name System (DNS) servers are queried.)

Primer_Networking_10. What cmd.exe tool will display NetBIOS transport statistics in Windows?
Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/nbtstat
Answer: nbtstat

Primer_Surveys_1. What team survey is focused on security and auditing?
______ Team
Research: https://www.coursera.org/articles/red-team-vs-blue-team
Answer: RED (I think it's the blue team)

Primer_Surveys_2. What type of survey is focused on computer system settings, updates, configurations and installed software?
________ Team
Research: https://ine.com/blog/understanding-blue-team-roles
Answer: BLUE

Primer_Surveys_3. What type of survey is focused on malware detection, artifact detection and investigating processes?
Research: https://learn.microsoft.com/en-us/security/compass/incident-response-overview
Answer: Incident Response

Windows_Memory_Analysis_Plugin_1. What Volatility plugin will dump a process to an executable file sample?
Answer: procdump

Windows_Memory_Analysis_Plugin_2. What Volatility plugin will extract command history by scanning for _COMMAND_HISTORY?
Answer: cmdscan

Windows_Memory_Analysis_Plugin_3.What Volatility plugin will show driver objects?
Answer: driverscan

Windows_Memory_Analysis_Basics_2. 
What command do you run to find which memory profile to use with a memory image?
Answer: imageinfo (volatility imageinfo -f <memory_image>)

Windows_Memory_Analysis_Basics_1. What switch/argument will list all plugins for Volatility?
Answer: --help (however, everything on the internet thinks it's actuall '--info')

Windows_Volatility_Data. In terms of Volatile Data, what locations are the MOST volatile?
Flag format: location,location
Answer: CPU registers, cache

Windows_Memory_Analysis_Basics_3. What is the 12th plugin listed in the Volatility help menu?
Open volatility
PS C:\Users\andy.dwyer\Desktop\Memory Analysis> .\volatility_2.6_win64_standalone.exe -h
Answer: cmdscan

Windows_Memory_Analysis_Basics_4. What profile do you use in conjunction with this memory image?
Use the following file (memory image) to answer the rest of the Memory Analysis challenges.
0zapftis.vmem
PS C:\Users\andy.dwyer\Desktop\Memory_Analysis> .\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" imageinfo
Answer: WinXPSP2x86 

Windows_Malware_1. What command did the attacker type to check the status of the malware?
PS C:\Users\andy.dwyer\Desktop\Memory_Analysis> .\volatility_2.6_win64_standalone.exe -f ".\0zapftis.vmem" --profile=WinXPSP2x86 cmdscan
Answer: sc query malware

Windows_Malware_2. What are the last 7 digits of the memory offset for the driver used by the malware?














