ROCR-002-W
10.50.29.33
Stack ID 3
start 2347
registry start357
ads start3486

https://vta.cybbh.space/horizon/project/instances/

Intro and Setup
field guide: https://os.cybbh.io/public/os/latest/
navigate to 10.50.21.26:8000
join class W23002 password

What version of PS am I using
PS C:\> Get-Host | Select-Object Version

To switch versions
PS C:\> pwsh

Primer_CLI_1. Which program starts with every CMD and PowerShell instance in Windows 7 and later?

Research: https://devblogs.microsoft.com/commandline/windows-command-line-inside-the-windows-console/

Answer: conhost.exe

Primer_CLI_2. What Windows 10 feature supports installing Linux subsystem?

Research: https://learn.microsoft.com/en-us/windows/wsl/about

Answer: WSL (Windows Subsystem for Linux)

Primer_CLI_3. Which Windows feature can be used to interact with any CLI on the Windows system concurrently using multiple tabs?

Research: https://learn.microsoft.com/en-us/windows/terminal/

Answer: Windows Terminal

Primer_CLI_4. What was the default shell (command line) of Windows versions Windows 2000 through Windows 8.1?

Research: https://learn.microsoft.com/en-us/windows-hardware/customize/enterprise/shell-launcher

Answer: cmd.exe

Primer_CLI_5. What data type do all cmd.exe commands return?

Research: https://en.wikipedia.org/wiki/Comparison_of_command_shells (Hint: What data type is "text"?)

Answer: string

Primer_CLI_6. What framework is PowerShell built on?

Research: https://en.wikipedia.org/wiki/.NET

Answer: .net

Primer_CLI_7. "What will all of the below give you?

(get-host).version

$host.version

$psversiontable.psversion"

Research: https://devblogs.microsoft.com/scripting/powertip-check-version-of-powershell/

Answer: Powershell Version

Primer_CLI_8. After PowerShell Core is installed what CLI command launches it?

Research: https://learn.microsoft.com/en-us/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.2

Answer: pwsh

Primer_CLI_9. "After PowerShell Core is installed you can still run the built in version of PowerShell side-by-side. What CLI command will launch the built in version?"

Research: Primer_CLI_9 https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/powershell

Answer: powershell.exe

Windows_PowerShell_Basics_1. 

What syntax do PowerShell cmdlets follow?

Answer: verb-noun

Windows_PowerShell_Basics_2. What PS command will list all PowerShell cmdlets?

Answer: Get-Command

Windows_PowerShell_Basics_3. What PowerShell command will list all verbs?

Answer: Get-Verb

Windows_PowerShell_Basics_4. BASH commands output strings. PowerShell commands output what data type?

Answer: object
 
Windows_PowerShell_Basics_5. All PowerShell objects are comprised of what two things?

Flag format: things,things

Answer: properties,methods

Windows_PowerShell_Basics_6. What command will list all things that make up a PowerShell object?

Answer: Get-Member

Windows_PowerShell_Basics_7. What PowerShell command will list PowerShell aliases?

Answer: Get-Alias

Windows_PowerShell_Basics_8. What PowerShell command lists all of the contents of a directory?

Answer: Get-ChildItem

Windows_PowerShell_Help_1. What is the basic cmdlet that displays help about Windows Powershell cmdlets and concepts?

Answer: Get-Help

Windows_PowerShell_Help_2. PowerShell "help files" don't show the entire help file with a basic command. What switch option shows the entire help file?

Answer: -Full

Windows_PowerShell_Help_3. What PowerShell command will update the PowerShell "help files" to the latest version?

Answer: Update-Help

Windows_PowerShell_Help_5. What help switch will show you the "help files" on Microsoft's website, in your default browser?

Answer: -Online

Windows_PowerShell_Interaction_1. What command will start the Chrome browser on your machine?

Answer: start chrome

Windows_PowerShell_Interaction_2. What command using a PS Method will stop chrome?

Flag is the full command.

Answer: (get-process chrome).kill()

Windows_PowerShell_Interaction_3. What PowerShell command (without using a method) will stop the Chrome process?

Answer: Stop-Process -name chrome

Windows_PowerShell_CimClasses_1.

PowerShell doesn't have a native cmdlet that will give you processor information (such as get-processor or get-cpu). Knowing this information might be necessary. What command would give you information about the system's processor?

Flag is the full command

Answer: Get-WmiObject -Class Win32_Processor

Windows_PowerShell_Logic_1. What PowerShell command will read a text file?

Answer: Get-Content

Windows_PowerShell_Logic_2. What PowerShell command will allow for counting lines in a file, averaging numbers, and summing numbers?

Answer: Measure-Object

Windows_PowerShell_Regex_1. What PowerShell command searches for text patterns in a string?

Answer: Select-String

Windows_PowerShell_Basics_9. Users' files are stored in their corresponding home directory. What is the literal path to all home directories on a Windows 10 system?

Answer: C:\Users\

Windows_PowerShell_Basics_7. How many properties are available for the get-process cmdlet?

Note: Property values only

Answer: 52

Windows_PowerShell_Alias_3. How many aliases does PowerShell have for listing the contents of a directory?

Answer: 3

Windows_PowerShell_Help_4. When requesting the help file for the get-process cmdlet, what full command is the 9th example given?

Answer: get-process powershell

Windows_PowerShell_CimClasses_2. To complete this challenge, find the description of the Lego Land service.

Get-WmiObject win32_service | ?{$_.NAME -like 'LegoLand'} | select Name,Description

Answer: i_love_legos

Windows_PowerShell_Logic_3. In the CTF folder on the CTF User's Desktop, count the number of words in words2.txt.

(Get-Content .\words2.txt).count

Answer: 5254

Windows_PowerShell_Logic_4. Count the number of files in the Videos folder in the CTF user's home directory.

(Get-ChildItem -Path .\Videos\).count

Andwer: 925

Windows_PowerShell_Logic_5. Find the only line that makes the two files in the CTF user's Downloads folder different.

Hint The flag is the string (not line number).

diff (Get-Content new.txt) (Get-Content old.txt))

Answer: popeye

Windows_PowerShell_Logic_6. The password is the 21st line from the top, in ASCII alphabetically-sorted, descending order of the words.txt file.

**Note: File Location - C:\Users\CTF\Desktop\CTF

(Get-Content .\words.txt | sort -Descending)[20]

Answer: ZzZp

Windows_PowerShell_Logic_7. Count the number of unique words in words.txt

**Note: File Location - C:\Users\CTF\Desktop\CTF

$A = $(foreach ($line in Get-Content .\words.txt) {$line.tolower().split(" ")}) | sort | Get-Unique

$A.count

Answer: 456976

Windows_PowerShell_Basics_8. How many methods are available for the get-process cmdlet?

Machine: Admin_Station

Answer: 14

Windows_Powershell_Logic_9. Count the number of folders in the Music folder in the CTF user’s profile.

(get-ChildItem -Path .\Music\).count

Answer: 411

Windows_PowerShell_Regex_2
10

Count the number of times, case-insensitive, gaab is listed in words.txt **Note: File Location - C:\Users\CTF\Desktop\CTF

(Get-Content .\words.txt | Select-String "gaab").count

Answer: 1

Windows_PowerShell_Regex_3. Count the number of words, case-insensitive, with either a or z in a word, in the words.txt file

    Note: File Location - C:\Users\CTF\Desktop\CTF
    Hint: There are multiple "words" on each line.

$A = $(foreach ($line in Get-Content .\words.txt) {$line.tolower().split(" ")}) -match '[az]+'

$A.count

Answer: 160352

Windows_PowerShell_Logic_8. Use a PowerShell loop to unzip the Omega file 1,000 times and read what is inside.

Note: Make sure you back up the .zip file to a different directory before attempting this challenge.

Omega"$n".zip

for ($n = 1000; $n -gt 0; $n--){Expand-Archive .\omega"$n".zip -DestinationPath .} 

Answer: king-fu

Windows_PowerShell_Regex_5. Count the number of words in words.txt that meet the following criteria:

    a appears at least twice consecutively
    and is followed immediately by any of the letters a through g
    Note: File Location - C:\Users\CTF\Desktop\CTF
    Example: aac...aaa...

$pattern = "[a-g]"    
$A = $(foreach ($line in Get-Content .\words.txt) {$line.tolower().split(" ")}) -match ".*aa$pattern*."
$A.count

Answer: 357

Windows_PowerShell_Profiles_8. Challenge only allows ONE attempt

Malware is running in a PowerShell profile on the File-Server. Based on PowerShell profile order of precedence (what is read first), find the correct flag.

The flag is the string after the #, without the preceding space.

Get-Content $PROFILE.AllUsersAllHosts

Answer: I am definitely not the malware

Windows_PowerShell_Profiles_1.5 Which PowerShell profile has the lowest precedence?

Answer: CurrentUserCurrentHost

Windows_PowerShell_Profiles_2. Which PowerShell profile has the highest precedence?

Answer: AllUsersAllHosts

Windows_PowerShell_Profiles_3. Which PowerShell variable stores the current user’s home directory?

Answer: $HOME

Windows_PowerShell_Profiles_4.

Which PowerShell variable stores the installation directory for PowerShell?

Answer: $PsHome

Windows_PowerShell_Profiles_5. Which PowerShell variable stores the path to the "Current User, Current Host" profile?

Answer: $PROFILE

Windows_PowerShell_Profiles_6. What command would you run to view the help for PowerShell Profiles?

Answer: Get-Help about_profiles

Windows_PowerShell_Profiles_7. What command would tell you if there was a profile loaded for All Users All Hosts?

Flag is the full command syntax

Answer: Test-Path -Path $PROFILE.AllUsersAllHosts




Primer_Registry_1. What Windows registry path is the Volatile Hive?

Research: https://vistech.net/~champ/online-docs/books/mwin2reg/ch11-30975.html

Answer: HKLM\HARDWARE

Primer_Registry_2. What registry key creates the Wow6432Node to represent 32-bit applications that run on a 64-bit version of Windows?

Research: https://learn.microsoft.com/en-us/troubleshoot/windows-client/application-management/wow6432node-registry-key-present-32-bit-machine

Answer: HKEY_LOCAL_MACHINE\SOFTWARE

Primer_Registry_3. In what registry path are the BOOT_START drivers located?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree

Answer: HKLM\SYSTEM\CurrentControlSet\Services

Primer_Registry_4. What start value do BOOT_START drivers have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order

Answer: 0x0

Primer_Registry_5. During kernel initialization, what registry location is read containing all SYSTEM_START drivers and services with a start value of 0x1?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hklm-system-currentcontrolset-services-registry-tree

Answer: HKLM\SYSTEM\CurrentControlSet\Services

Primer_Registry_6. Auto_START drivers and services are loaded after kernel initialization. What start value do they have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order

Answer: 0x02

Primer_Registry_7. What start value do DEMAND_START drivers and services have in the registry?

Research: https://learn.microsoft.com/en-us/windows-hardware/drivers/install/specifying-driver-load-order

Answer: 0x3

Primer_Registry_8. When accessing a remote registry which are the only 2 accessible HKEYs?

SYNTAX Hive, Hive

Research: https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/reg-load

Answer: HKLM, HKU

Primer_Registry_9. What PowerShell cmdlet will list currently mapped drives?

Research: https://learn.microsoft.com/en-us/powershell/scripting/samples/managing-windows-powershell-drives?view=powershell-7.2

Answer: Get-PSDrive

Primer_Registry_10. What is the native Windows GUI tool for managing the registry?

Research: https://support.microsoft.com/en-us/windows/how-to-open-registry-editor-in-windows-10-deab38e6-91d6-e0aa-4b7c-8878d9e07b11

Answer: regedit.exe

Windows_Registry_Basics_1. What registry hive contains all machine settings?

Answer: HKEY_LOCAL_MACHINE

Windows_Registry_Basics_2. What registry hive contains all user settings?

Answer: HKEY_USERS

Windows_Registry_Basics_3. What registry hive contains only the currently logged-in user's settings?

Answer: HKEY_CURRENT_USER

Windows_Registry_Basics_4. The HKEY_CURRENT_USER registry hive is a symbolic link to another registry subkey. What is the subkey that it is linked to?

Flag format: HIVE\SID.........................

Answer: HKEY_USERS\S-1-5-21-105181296-3876013222-3871917967-1000














